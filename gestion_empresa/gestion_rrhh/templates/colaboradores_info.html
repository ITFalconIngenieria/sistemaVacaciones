{% extends 'base.html' %}

{% block title %}Información de Colaboradores{% endblock %}

{% block content %}
<div class="container mt-4">
    <h2>Información de Colaboradores</h2>

    <!-- Contenedor con scroll -->
    <div style="overflow-x: auto; max-height: 80vh;">
        <table class="table table-striped" id="colaboradores-table">
            <thead style="position: sticky; top: 0; background-color: white; z-index: 1;">
                <tr>
                    <!-- Añadimos estilos para el cursor -->
                    <th style="cursor: pointer;" onclick="sortTable(0)">Nombre <span>&#9650;&#9660;</span></th>
                    <th style="cursor: pointer;" onclick="sortTable(1)">Vacaciones Disponibles <span>&#9650;&#9660;</span></th>
                    <th style="cursor: pointer;" onclick="sortTable(2)">Horas Compensatorias <span>&#9650;&#9660;</span></th>
                    <th style="cursor: pointer;" onclick="sortTable(3)">Horas Extras <span>&#9650;&#9660;</span></th>
                </tr>
            </thead>
            <tbody>
                {% for data in colaboradores_data %}
                <tr>
                    <td>{{ data.usuario.get_full_name }}</td>
                    <td>{{ data.dias_data.dias_disponibles }}</td>
                    <td>{{ data.horas_data.HC }}</td>
                    <td>{{ data.horas_data.HE }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>

<!-- Script para ordenar la tabla -->
<script>
    function sortTable(columnIndex) {
        const table = document.getElementById('colaboradores-table');
        const rows = Array.from(table.rows).slice(1); // Excluye encabezado
        const isAscending = table.getAttribute('data-sort-order') !== 'asc'; // Alternar orden

        rows.sort((a, b) => {
            const cellA = a.cells[columnIndex].innerText.trim().toLowerCase();
            const cellB = b.cells[columnIndex].innerText.trim().toLowerCase();

            // Convertir a números si son valores numéricos
            const valueA = isNaN(cellA) ? cellA : parseFloat(cellA);
            const valueB = isNaN(cellB) ? cellB : parseFloat(cellB);

            return isAscending
                ? valueA > valueB ? 1 : -1
                : valueA < valueB ? 1 : -1;
        });

        // Reordenar las filas en la tabla
        rows.forEach(row => table.tBodies[0].appendChild(row));

        // Alternar el atributo de orden
        table.setAttribute('data-sort-order', isAscending ? 'asc' : 'desc');
    }
</script>
{% endblock %}
